(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{441:function(e,t,a){"use strict";a.r(t);var n=a(46),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"serial-console"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#serial-console"}},[e._v("#")]),e._v(" Serial console")]),e._v(" "),a("p",[e._v("If the machine is only providing serial output during bootup, then it\nmay not have been configured for serial logins. Check that the\n"),a("code",[e._v("/etc/inittab")]),e._v(" file contains a line like")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("T0:23:respawn:/sbin/getty -L ttyS0 9600 vt100\n")])])]),a("p",[e._v("which tells init to start the program to provide login prompts.")]),e._v(" "),a("p",[e._v("The original kernel shipped with Debian sarge has a broken serial driver\nfor Ultra 5s. The version in the security updates should work.")]),e._v(" "),a("h2",{attrs:{id:"restricting-access-to-admins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#restricting-access-to-admins"}},[e._v("#")]),e._v(" Restricting access to admins")]),e._v(" "),a("p",[e._v("In "),a("code",[e._v("/etc/security/access.conf")]),e._v(" add")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("+:ALL:cron\n-:ALL EXCEPT root admin:ALL\n")])])]),a("p",[e._v("[Hmmm... maybe that should be "),a("code",[e._v("LOCAL")]),e._v(" instead of "),a("code",[e._v("cron")]),e._v(".]")]),e._v(" "),a("p",[e._v("Ensure that "),a("code",[e._v("/etc/pam.d/common-account")]),e._v(" ensure that the pam_access\nmodule is used to restrict access. For example,")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("account [success=1 default=ignore]      pam_unix.so debug\naccount required                        pam_ldap.so debug\naccount required                        pam_access.so\n")])])]),a("h2",{attrs:{id:"multiple-vlans"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multiple-vlans"}},[e._v("#")]),e._v(" Multiple VLANs")]),e._v(" "),a("p",[e._v("Some systems need to appear on several VLANs, most notably the router.\nFirst, add")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("8021q\n")])])]),a("p",[e._v("to the end of "),a("code",[e._v("/etc/modules")]),e._v(" so that the kernel knows how to deal with\nthe VLAN tagged packets. (Use "),a("code",[e._v("modprobe 8021q")]),e._v(" to load it immediately if\nyou don't want to reboot.) Then install the "),a("code",[e._v("vlan")]),e._v(" Debian package, and\nadd extra stanzas to "),a("code",[e._v("/etc/network/interfaces")]),e._v(" for the new VLANs. For\nexample,")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("# Admin VLAN\nauto eth0.1\niface eth0.1 inet static\n        address 192.168.1.6\n        netmask 255.255.255.0\n        network 192.168.1.0\n        broadcast 192.168.1.255\n")])])]),a("p",[e._v("where "),a("code",[e._v("eth0.1")]),e._v(" means VLAN number "),a("code",[e._v("1")]),e._v(" on interface "),a("code",[e._v("eth0")]),e._v(". Finally,\nconfigure the switch so that the port is on the extra VLANs.")]),e._v(" "),a("p",[e._v("Some ethernet hardware does not like the slightly larger ethernet frames\nused by VLAN tagging. We have already had problems with\n"),a("a",{attrs:{href:"http://osdir.com/ml/ports.sparc/2003-07/msg00025.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("sunhme"),a("OutboundLink")],1),e._v(" and a\nfour port tulip card. You can test it by sending large pings:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("ping -s 1472 davison.tardis.ed.ac.uk\n")])])]),a("p",[e._v("These will produce a frame that is as large as possible (fragmenting the\nping, if necessary). If the hardware or driver does not support large\nframes properly then that frame may be lost. If you are curious about\nwhich direction is failing, you can check with wireshark ("),a("code",[e._v("tshark")]),e._v(") or\ntcpdump.")]),e._v(" "),a("p",[e._v("We have had success with a 3c905 PCI card, and the old 10Mb/s subqe\ninterfaces.")]),e._v(" "),a("h2",{attrs:{id:"logging-to-the-log-host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logging-to-the-log-host"}},[e._v("#")]),e._v(" Logging to the "),a("a",{attrs:{href:"Log_host",title:"wikilink"}},[e._v("Log host")])]),e._v(" "),a("p",[e._v("To make "),a("strong",[e._v("syslog")]),e._v(" send logs to the log host, put")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("*.*     @loghost\n")])])]),a("p",[e._v("into "),a("code",[e._v("/etc/syslog.conf")]),e._v(". To make "),a("strong",[e._v("rsyslog")]),e._v(" send logs to the log host,\nput")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v('$template sysklogd,"<%PRI%>%TIMESTAMP% %syslogtag%%msg%"\n*.* @loghost;sysklogd\n')])])]),a("p",[e._v("into "),a("code",[e._v("/etc/rsyslog.conf")]),e._v(". (At least until we change the syslogd on the\nloghost.)")]),e._v(" "),a("p",[e._v("It is a good idea to keep the local logging too, in case of network\nproblems.")]),e._v(" "),a("h2",{attrs:{id:"email-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#email-config"}},[e._v("#")]),e._v(" Email config")]),e._v(" "),a("p",[e._v("Install the exim4 package and execute 'dpkg-reconfigure exim4-config' to\nconfigure it with the details below:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("Split configuration into small files:                      NO\nGeneral type of mail configuration:                        mail sent by smarthost; no local mail\nSystem mail name:                                          HOSTNAME.tardis.ed.ac.uk\nIP-addresses to listen on for incoming SMTP connections:   127.0.0.1\nOther destinations for which mail is accepted:             HOSTNAME.tardis.ed.ac.uk\nVisible domain name for local users:                       tardis.ed.ac.uk\nIP address or host name of the outgoing smarthost:         mailhost.tardis.ed.ac.uk\nKeep number of DNS-queries minimal (Dial-on-Demand):       NO\n")])])]),a("h2",{attrs:{id:"email-client-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#email-client-config"}},[e._v("#")]),e._v(" Email client config")]),e._v(" "),a("p",[e._v("Email clients need to be told to look in "),a("code",[e._v("~/Maildir")]),e._v(".")]),e._v(" "),a("p",[e._v("For mutt on Debian you can create a file "),a("code",[e._v("/etc/Muttrc.d/tardis.rc")]),e._v("\n(creating the directory if it isn't already there) containing:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("# On Tardis we deliver here by default\nset spoolfile='~/Maildir'\n")])])]),a("h2",{attrs:{id:"ntp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ntp"}},[e._v("#")]),e._v(" NTP")]),e._v(" "),a("p",[e._v("Our router, "),a("code",[e._v("davison")]),e._v(", provides other machine with an NTP service. In\nturn, it synchronises with the (external-facing) Informatics servers.\nHere's how to update '/etc/ntp.conf':")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("--- /etc/ntp.conf       (revision 17)\n+++ /etc/ntp.conf       (working copy)\n@@ -10,17 +10,8 @@\n\n\n # You do need to talk to an NTP server or two (or three).\n-#server ntp.your-provider.example\n+server router.tardis.ed.ac.uk\n\n-# pool.ntp.org maps to more than 300 low-stratum NTP servers.\n-# Your server will pick a different set every time it starts up.\n-#  *** Please consider joining the pool! ***\n-#  *** <http://www.pool.ntp.org/join.html> ***\n-server 0.debian.pool.ntp.org iburst\n-server 1.debian.pool.ntp.org iburst\n-server 2.debian.pool.ntp.org iburst\n-server 3.debian.pool.ntp.org iburst\n-\n # By default, exchange time with everybody, but don't allow configuration.\n # See /usr/share/doc/ntp-doc/html/accopt.html for details.\n restrict -4 default kod notrap nomodify nopeer noquery\n")])])]),a("h2",{attrs:{id:"munin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#munin"}},[e._v("#")]),e._v(" Munin")]),e._v(" "),a("p",[e._v("Install munin-node on the client (the new Linux box) and update\n'/etc/munin/munin-node.conf' like so:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("--- etc/munin/munin-node.conf   (revision 28)\n+++ etc/munin/munin-node.conf   (working copy)\n@@ -34,4 +34,4 @@\n # the allow line as many times as you'd like\n\n allow ^127\\.0\\.0\\.1$\n-\n+allow ^193.62.81.11$\n")])])]),a("p",[e._v("Then run '/etc/init.d/munin-node restart' to update the daemon. Connect\nto the web server and update '/etc/munin/munin.conf' like so:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("--- munin.conf.pert     2007-06-22 17:47:27.593900598 +0100\n+++ munin.conf  2007-06-22 17:48:26.781493093 +0100\n@@ -101,9 +101,11 @@\n [mara.tardis.ed.ac.uk]\n     address 193.62.81.15\n     use_node_name yes\n\n-\n+[wotan.tardis.ed.ac.uk]\n+    address 193.62.81.4\n+    use_node_name yes\n")])])]),a("h2",{attrs:{id:"server-addresses"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server-addresses"}},[e._v("#")]),e._v(" Server addresses")]),e._v(" "),a("h2",{attrs:{id:"see-also"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#see-also"}},[e._v("#")]),e._v(" See also")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"Updating_Systems",title:"wikilink"}},[e._v("Updating Systems")])]),e._v(" "),a("li",[a("a",{attrs:{href:"Log_host",title:"wikilink"}},[e._v("Log host")])])]),e._v(" "),a("h2",{attrs:{id:"other-stuff-that-should-be-documented-here-but-isn-t"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#other-stuff-that-should-be-documented-here-but-isn-t"}},[e._v("#")]),e._v(" Other stuff that should be documented here, but isn't")]),e._v(" "),a("ul",[a("li",[e._v("Configuring machines to pass mail on to the mail hub")]),e._v(" "),a("li",[e._v("Configuring ntp")]),e._v(" "),a("li",[e._v("Booting our suns from the LAN")]),e._v(" "),a("li",[e._v("Installing munin")])]),e._v(" "),a("p",[a("a",{attrs:{href:"category:infrastructure",title:"wikilink"}},[e._v("category:infrastructure")])]),e._v(" "),a("p",[a("a",{attrs:{href:"Category:OutOfDate",title:"wikilink"}},[e._v("Category:OutOfDate")]),e._v(" "),a("a",{attrs:{href:"Category:Admin_Documents",title:"wikilink"}},[e._v("Category:Admin_Documents")])])])}),[],!1,null,null,null);t.default=s.exports}}]);