(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{438:function(e,t,a){"use strict";a.r(t);var n=a(46),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("I found\n"),a("a",{attrs:{href:"http://www.debian-administration.org/articles/585#NSS_configuration",target:"_blank",rel:"noopener noreferrer"}},[e._v("this"),a("OutboundLink")],1),e._v("\nguide to be very useful as it lists answers to the debconf questions.\nThe only difference between the recommended configuration and tardis' is\nthat \"Local crypt to use when changing passwords.\" should be 'exop'.")]),e._v(" "),a("h2",{attrs:{id:"getting-user-information-from-ldap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getting-user-information-from-ldap"}},[e._v("#")]),e._v(" Getting user information from "),a("a",{attrs:{href:"LDAP",title:"wikilink"}},[e._v("LDAP")])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("libnss-ldap")]),e._v(" package handles fetching account information from\nLDAP. Also make sure that "),a("code",[e._v("nscd")]),e._v(" is installed, otherwise "),a("a",{attrs:{href:"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=190072",target:"_blank",rel:"noopener noreferrer"}},[e._v("bad\nthings"),a("OutboundLink")],1),e._v(" may\nhappen.")]),e._v(" "),a("p",[e._v("To tell "),a("code",[e._v("libnss-ldap")]),e._v(" where to look, you need to edit the\n"),a("code",[e._v("/etc/libnss-ldap.conf")]),e._v(". At the very least, you'll need to give the host\nand base ("),a("code",[e._v("dc=tardis,dc=ed,dc=ac,dc=uk")]),e._v(").")]),e._v(" "),a("p",[e._v("To tell libc to use "),a("code",[e._v("libnss-ldap")]),e._v(", you need to amend the appropriate\nlines in "),a("code",[e._v("/etc/nsswitch.conf")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("passwd:         files ldap\ngroup:          files ldap\nshadow:         files ldap\n")])])]),a("p",[e._v("The other databases are best left alone; we don't bother putting host\ninformation or such like in LDAP because we don't see much benefit.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("getent")]),e._v(" program is useful for testing.")]),e._v(" "),a("h2",{attrs:{id:"authenticating-with-ldap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authenticating-with-ldap"}},[e._v("#")]),e._v(" Authenticating with "),a("a",{attrs:{href:"LDAP",title:"wikilink"}},[e._v("LDAP")])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("libpam-ldap")]),e._v(" package is used for authentication against LDAP. You\nneed to configure "),a("code",[e._v("/etc/pam_ldap.conf")]),e._v(" along the same lines as\n"),a("code",[e._v("/etc/libnss_ldap.conf")]),e._v(". A typical example is:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("host piper\nbase dc=tardis,dc=ed,dc=ac,dc=uk\nrootbinddn cn=admin,dc=tardis,dc=ed,dc=ac,dc=uk\nldap_version 3\n\n# NSS lookups need to be restricted to the appropriate parts of the tree.\n# If other lookups are added to /etc/nsswitch.conf, they need to be put\n# here too.\nnss_base_passwd ou=People,dc=tardis,dc=ed,dc=ac,dc=uk\nnss_base_group   ou=Group,dc=tardis,dc=ed,dc=ac,dc=uk\nnss_base_shadow ou=People,dc=tardis,dc=ed,dc=ac,dc=uk\n\n# Use funky generic LDAP password changing.\npam_password exop\n")])])]),a("p",[e._v("PAM needs to be told to use "),a("code",[e._v("libpam-ldap")]),e._v(", as well as the normal\nauthentication for "),a("code",[e._v("root")]),e._v(". Canonical "),a("code",[e._v("/etc/pam.d/common-auth")]),e._v(":")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("# ** Use trick from /usr/share/doc/libpam-ldap/README.Debian\n#\nauth    [success=1 default=ignore]      pam_unix.so nullok_secure\nauth    required                        pam_ldap.so use_first_pass\nauth    required                        pam_permit.so\n")])])]),a("p",[e._v("Note the "),a("code",[e._v("use_first_pass")]),e._v(" option. Without it logins will ask for a\npassword for pam_unix, then one for pam_ldap, and so on, causing every\nother attempt to enter your password to fail even when you get it right.\nYou need to set up "),a("code",[e._v("/etc/pam.d/common-account")]),e._v(" in the same way.")]),e._v(" "),a("h2",{attrs:{id:"for-red-hat-based-distros"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#for-red-hat-based-distros"}},[e._v("#")]),e._v(" For Red Hat-based Distros")]),e._v(" "),a("p",[e._v("This guide was tested with Fedora Server 21 (on\n"),a("a",{attrs:{href:"Valiant",title:"wikilink"}},[e._v("Valiant")]),e._v(").")]),e._v(" "),a("ul",[a("li",[e._v("Run `authconfig-tui` (if not installed, `yum install -y\nauthconfig`")]),e._v(" "),a("li",[e._v("Check 'Use LDAP' and 'Use LDAP Authentication'. Make sure 'Local\nauthorization is sufficient' is also checked.")]),e._v(" "),a("li",[e._v("Leave `Use TLS` unchecked.")]),e._v(" "),a("li",[e._v("Set server to `ldap://ldap/`")]),e._v(" "),a("li",[e._v("Set Base DN to `dc=tardis,dc=ed,dc=ac,dc=uk`")])]),e._v(" "),a("p",[e._v("Easy!")]),e._v(" "),a("p",[a("a",{attrs:{href:"Category:OutOfDate",title:"wikilink"}},[e._v("Category:OutOfDate")]),e._v(" "),a("a",{attrs:{href:"Category:Admin_Documents",title:"wikilink"}},[e._v("Category:Admin_Documents")])])])}),[],!1,null,null,null);t.default=s.exports}}]);