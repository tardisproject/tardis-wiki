(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{491:function(e,t,a){"use strict";a.r(t);var n=a(46),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"tardis-solaris-installation-configuation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tardis-solaris-installation-configuation"}},[e._v("#")]),e._v(" Tardis Solaris Installation/Configuation")]),e._v(" "),a("p",[e._v("A fairly minimal guide to running Solaris on to Tardis systems.")]),e._v(" "),a("h2",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation"}},[e._v("#")]),e._v(" Installation")]),e._v(" "),a("h3",{attrs:{id:"pre-requisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pre-requisites"}},[e._v("#")]),e._v(" Pre-requisites")]),e._v(" "),a("ul",[a("li",[e._v("Computer - wired in, serial consoled, networked")]),e._v(" "),a("li",[e._v("Install media (or install jumpstart server)")]),e._v(" "),a("li",[e._v("IP address - find something free in appropriate VLAN/subnet")]),e._v(" "),a("li",[e._v("Hostname - pick something, have DNS admin add it to the DNS")])]),e._v(" "),a("h3",{attrs:{id:"pre-install-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pre-install-setup"}},[e._v("#")]),e._v(" Pre-install setup")]),e._v(" "),a("p",[e._v("Attempt to do the following "),a("em",[e._v("before")]),e._v(" installing the new machine.\nGenerally you will require someone else to to complete some or all of\nthese tasks, depending on whether you have/need access to the\nSpiderport/Switch/Firewall configuration.")]),e._v(" "),a("h4",{attrs:{id:"configure-spiderport"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configure-spiderport"}},[e._v("#")]),e._v(" Configure spiderport")]),e._v(" "),a("p",[e._v("Login to\n"),a("a",{attrs:{href:"http://www.tardis.ed.ac.uk/admin/systems/spiderport.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("spiderport"),a("OutboundLink")],1),e._v("\n(requires access to admin machine, eg baker or davison) and configure\ntcp port "),a("em",[e._v("n")]),e._v(" to map to the serial port you plugged the new machine into,\nwhere "),a("em",[e._v("n")]),e._v(" is the last octet of the IP address chosen for the new system.")]),e._v(" "),a("h4",{attrs:{id:"vlan-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vlan-install"}},[e._v("#")]),e._v(" VLAN install")]),e._v(" "),a("p",[e._v("Login to "),a("a",{attrs:{href:"http://www.tardis.ed.ac.uk/admin/net",target:"_blank",rel:"noopener noreferrer"}},[e._v("switch"),a("OutboundLink")],1),e._v(", map chosen\nethernet port into the approriate VLAN.")]),e._v(" "),a("h4",{attrs:{id:"firewall-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#firewall-configuration"}},[e._v("#")]),e._v(" Firewall configuration")]),e._v(" "),a("ul",[a("li",[e._v("Allow outgoing DNS, HTTP Proxy Access (if required).")]),e._v(" "),a("li",[e._v("Allow incoming SSH (if required).")])]),e._v(" "),a("h3",{attrs:{id:"solaris-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#solaris-install"}},[e._v("#")]),e._v(" Solaris Install")]),e._v(" "),a("p",[e._v("Put install media in drive.")]),e._v(" "),a("p",[e._v("Connect to the serial console on the new machine (would advise running\nthis inside a screen session, in case the connection fails and context\nis lost). Drop machine to the prom (^] then send break from the telnet>\nprompt), type boot cdrom at the go prompt to begin the interactive\ninstaller program.")]),e._v(" "),a("p",[e._v("Most of the questions in the installer program can be answered with\ncommon sense. Remeber to use "),a("esc",[e._v("n instead of Fn to progress through\nthe menus.")])],1),e._v(" "),a("h4",{attrs:{id:"responses-to-non-obvious-questions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#responses-to-non-obvious-questions"}},[e._v("#")]),e._v(" Responses to non-obvious questions")]),e._v(" "),a("p",[e._v("May not be conclusive, mostly from memory")]),e._v(" "),a("ul",[a("li",[e._v("Terminal type - choose 'xterms', it seems to work fine.")]),e._v(" "),a("li",[e._v("Install type - choose normal install. Install the whole solaris\nsystem (minus OEM support). The 'reduced networking support' option\nis much more minimally configured and could also be considered.")]),e._v(" "),a("li",[e._v("Disk layout - choose 'auto-layout', the customise. The defaults are\ninappropriate, make / considerably larger, do not have a seperate\n/export partition('slice'), allow for a sensible /var")])]),e._v(" "),a("h2",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("h3",{attrs:{id:"dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[e._v("#")]),e._v(" DNS")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cp /etc/nsswitch.dns /etc/nsswitch.conf\n")])])]),a("p",[e._v("Then edit /etc/resolv.conf to taste.")]),e._v(" "),a("h3",{attrs:{id:"ldap-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ldap-client"}},[e._v("#")]),e._v(" LDAP Client")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("ldapclient -v manual -a defaultSearchBase=dc=tardis,dc=ed,dc=ac,dc=uk \\\n    -a domainName=tardis.ed.ac.uk -a defaultServerList=193.62.81.2\n")])])]),a("p",[e._v("This messes up /etc/nsswitch.conf so you will need to re-add some of the\nchanges from /etc/nsswitch.dns or even revert to /etc/nsswitch.dns and\njust add ldap lookup for passwd and group.")]),e._v(" "),a("h3",{attrs:{id:"environment-tweaks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#environment-tweaks"}},[e._v("#")]),e._v(" Environment tweaks")]),e._v(" "),a("p",[e._v("Solaris comes with a fairly alien default configuration, especially if\nyou come from a GNU tools background. Things you may wish to do:")]),e._v(" "),a("ul",[a("li",[e._v("Set the default shell to bash rather than sh (this is safe in S10).")]),e._v(" "),a("li",[e._v("Set the default TERM variable to something less 'broken'.")]),e._v(" "),a("li",[e._v("Edit /etc/default/login and /etc/default/su setting PATH and SUPATH\nto:")])]),e._v(" "),a("p",[a("code",[e._v("/opt/csw/bin:/usr/sbin:/usr/bin:/usr/dt/bin:/usr/openwin/bin:/usr/ccs/bin")])]),e._v(" "),a("ul",[a("li",[e._v("Export an appropriate $http_proxy variable from /etc/profile.")])]),e._v(" "),a("h3",{attrs:{id:"_2-2-package-manager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-package-manager"}},[e._v("#")]),e._v(" 2.2 Package Manager")]),e._v(" "),a("p",[e._v("pkg-get is an apt-ish package manager for Solaris for installing\nunofficial community software builds. You can install pkg-get from\n"),a("a",{attrs:{href:"http://www.blastwave.org/howto.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("blastwave.org"),a("OutboundLink")],1),e._v(". Usage is fairly\ntrivial, eg:")]),e._v(" "),a("p",[a("code",[e._v("pkg-get -i vim")])]),e._v(" "),a("h3",{attrs:{id:"_2-3-minimise-network-exposure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-minimise-network-exposure"}},[e._v("#")]),e._v(" 2.3 Minimise Network Exposure")]),e._v(" "),a("p",[a("em",[e._v("TODO: using svcadm to disable the vast swathes of useless services")])]),e._v(" "),a("h3",{attrs:{id:"_2-4-solaris-zones"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-solaris-zones"}},[e._v("#")]),e._v(" 2.4 Solaris Zones")]),e._v(" "),a("p",[e._v("See "),a("a",{attrs:{href:"http://www.opensolaris.org/os/community/zones/faq/#sa_create",target:"_blank",rel:"noopener noreferrer"}},[e._v("Zones\nFAQ"),a("OutboundLink")],1),e._v(" on\n"),a("a",{attrs:{href:"http://www.opensolaris.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("opensolaris.org"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h4",{attrs:{id:"_2-4-1-creating-and-installing-a-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-1-creating-and-installing-a-zone"}},[e._v("#")]),e._v(" 2.4.1 Creating and installing a zone")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("reaper:~# zonecfg -z <zonename>\ndb: No such zone configured\nUse 'create' to begin configuring a new zone.\nzonecfg:db> create\nzonecfg:db> set zonepath=/zones/zone_roots/<zonename>\nzonecfg:db> add net\nzonecfg:db:net> set address=<zone ip addr>\nzonecfg:db:net> set physical=hme0\nzonecfg:db:net> end\nzonecfg:db> commit\nzonecfg:db> exit\n\nreaper:~# zoneadm -z <zonename> install\nreaper:~# zoneadm -z <zonename> boot\nreaper:~# zlogin -e] -C <zonename>\n")])])]),a("p",[e._v("Then follow the above guidelines on setting up the Solaris environment.")]),e._v(" "),a("h4",{attrs:{id:"useful-info"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#useful-info"}},[e._v("#")]),e._v(" Useful info")]),e._v(" "),a("h5",{attrs:{id:"connecting-to-the-console-on-a-zone"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connecting-to-the-console-on-a-zone"}},[e._v("#")]),e._v(" Connecting to the console on a zone")]),e._v(" "),a("p",[e._v("It is necessary to change the escape char for zlogin, because by default\nit is the same as ssh (~) which will create confusion if you're logged\nin through a chain of ssh sessions.")]),e._v(" "),a("p",[e._v("zlogin -e] -C "),a("zonename")],1),e._v(" "),a("p",[e._v("To disconnect from a zone, first log out, then type ]. after a newline.")]),e._v(" "),a("h5",{attrs:{id:"adding-user-accounts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adding-user-accounts"}},[e._v("#")]),e._v(" Adding user accounts")]),e._v(" "),a("p",[a("em",[e._v("(you cannot ssh into the root account)")])]),e._v(" "),a("ul",[a("li",[e._v("Disable autofs")])]),e._v(" "),a("p",[a("code",[e._v("svcadm disable svc:/system/filesystem/autofs:default")])]),e._v(" "),a("ul",[a("li",[e._v("Fix permissions on /home")])]),e._v(" "),a("p",[a("code",[e._v("chmod 755 /home")])]),e._v(" "),a("ul",[a("li",[e._v("Add account")])]),e._v(" "),a("p",[a("code",[e._v("useradd -m -d /home/username -s /bin/bash/ username")]),e._v(" "),a("code",[e._v("passwd username")])]),e._v(" "),a("p",[a("em",[e._v("This may all be fixable cleanly by leaving autofs running and following\nthe instructions in the comments\n"),a("a",{attrs:{href:"http://www.oreillynet.com/onlamp/blog/2006/03/solaris_first_install.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[a("a",{attrs:{href:"category:Admin_Documents",title:"wikilink"}},[e._v("category:Admin_Documents")])]),e._v(" "),a("p",[a("a",{attrs:{href:"Category:OutOfDate",title:"wikilink"}},[e._v("Category:OutOfDate")])])])}),[],!1,null,null,null);t.default=s.exports}}]);