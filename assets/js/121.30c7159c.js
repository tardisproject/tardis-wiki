(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{492:function(s,a,e){"use strict";e.r(a);var t=e(46),i=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"using-spamassassin-on-tardis"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-spamassassin-on-tardis"}},[s._v("#")]),s._v(" Using Spamassassin on Tardis")]),s._v(" "),e("h2",{attrs:{id:"setting-up-your-mail-account-to-use-spamassassin-with-procmail"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-your-mail-account-to-use-spamassassin-with-procmail"}},[s._v("#")]),s._v(" Setting up your mail account to use spamassassin with procmail")]),s._v(" "),e("p",[s._v("Create a mail folder for spam, use a '.' to make this folder\nIMAP-viewable.")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("maildirmake ~/Maildir/.SPAM\n")])])]),e("p",[s._v("Before beginning to modify your .procmailrc, first back it up, and use\nthe copy to make changes, as mail with a broken .procmailrc can get\nlost.")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  cp ~/.procmailrc ~/.procmailrc.new\n  vi ~/.procmailrc.new\n")])])]),e("p",[s._v("You may also want to log everything that procmail does with your mail\nwhile you are testing SpamAssassin. To do this, add the following line\nto your .procmailrc file:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  LOGFILE=$HOME/procmail.log\n")])])]),e("p",[s._v("(Don't forget to remove this line when you are finished, unless you want\nto use a tool such as mailstat for checking whats been going on with\nyour mail)")]),s._v(" "),e("p",[s._v("You will need to add the following rule to your .procmailrc file at the\nbeginning:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  :0fw:\n  | /usr/bin/spamc\n")])])]),e("p",[s._v("This will call spamassassin to be run against any new message that\narrive.")]),s._v(" "),e("p",[s._v("You then need to create a rule that pushes any spam into a separate mail\nfolder:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  :0:\n  * ^X-Spam-Status: Yes\n  $MAILDIR/.SPAM/new\n")])])]),e("p",[s._v("Spam will now begin to be pushed automatically into the .SPAM mail\nfolder instead of arriving in your Inbox. You should check this folder\nregularly to ensure that it is not catching real messages by mistake,\nand delete any spam that has been caught. (See below for tweaking\nSpamAssassin's settings).")]),s._v(" "),e("p",[s._v("You should now ensure that you are using procmail for your email by\nadding the following line to your ~/.forward file:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  \"|IFS=' ' && exec /usr/bin/procmail -f- || exit 75 #LOGIN\"\n")])])]),e("p",[s._v("(Where LOGIN is replaced with your username).")]),s._v(" "),e("h2",{attrs:{id:"setting-up-your-mail-account-to-use-spamassassin-with-maildrop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-your-mail-account-to-use-spamassassin-with-maildrop"}},[s._v("#")]),s._v(" Setting up your mail account to use spamassassin with maildrop")]),s._v(" "),e("p",[s._v("First, create the spam directory as above:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  maildirmake ~/Maildir/.SPAM\n")])])]),e("p",[s._v("Next, back up your .mailfilter as above:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  cp ~/.mailfilter ~/.mailfilter.new\n  vi ~/.mailfilter.new\n")])])]),e("p",[s._v("Now to set up your mailfilter. At the top of the file, shove this in:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v('#call spamassassin\n  exception {\n              xfilter "/usr/bin/spamassassin -x"\n            }\n# identified as spam?\n  if (/^X-Spam-Flag: *YES/)\n  {\n    # save the spam mail to the users special spam folder\n        to Maildir/.SPAM/\n        exit\n  }\n# seems, the mail isn\'t suspect, save it to the users inbox\nto Maildir\n')])])]),e("p",[s._v("finally make sure you're actually using maildrop by putting this in\n~/.forward:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  \"|IFS=' ' && exec /usr/bin/maildrop || exit 75 #LOGIN\"\n")])])]),e("p",[s._v("replacing LOGIN with your own username, and thats it (much nicer than\nprocmail ðŸ˜ƒ). Read on for information on configuring spamassassin.")]),s._v(" "),e("h2",{attrs:{id:"configuring-spamassassin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-spamassassin"}},[s._v("#")]),s._v(" Configuring spamassassin")]),s._v(" "),e("p",[s._v("SpamAssassin can be configured on a per-user basis, to best suit you. In\norde to do this, you will need to create a folder called '.spamassassin'\nin your home directory:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  mkdir ~/.spamassassin\n")])])]),e("p",[s._v("You should then create a file inside that directory called 'user_prefs'\nwhich will contain the settings you wish SpamAssassin to use when\nexamining your mail.")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  vi ~/.spamassassin/user_prefs\n")])])]),e("p",[s._v("There are several basic settings you will wish to add to this file:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("This is the default setting for SpamAssassin.\nWhen an email is examined, SpamAssassin gives the message points according to tests that define how 'spam-like' it is.\nThe number set in the 'required_hits' option defines the cut-off point above which messages are considered spam\nYou should adjust this number based on whether you receive too many false-positives (non-spam in your SPAM folder)\nor false-negatives (spam in your inbox).\n\n  required_hits 8.0\n\nThis setting lets you specifiy addresses that are definitely NOT spam. You can use the * and ? wildcards here.\nThis should be used if certain emails from individuals repeatedly end up in your SPAM box.\n\n  whitelist_from *@tardis.ed.ac.uk joe@notspam.com\n\n(NOTE: By default, messages sent from IP addresses within ed.ac.uk are considered non-spam.)\n\nThis setting lets you specify addresses that definitely ARE spam.\nHowever, in most cases, Bayesian filtering is a better option here. (See below).\n\n  blacklist_from spam@spammer.com\n")])])]),e("p",[s._v("Note: You can view all the available options open to you by looking at\nthe SpamAssasin man pages:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  man Mail::SpamAssassin::Conf\n")])])]),e("p",[s._v("The default tests that are run against emails can be seen at\n"),e("a",{attrs:{href:"http://www.spamassassin.org/tests.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.spamassassin.org/tests.html"),e("OutboundLink")],1),s._v(" You can change the number of\npoints a test will score as follows:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  score NAME_OF_TEST 3.0\n")])])]),e("p",[s._v("You can also disable a test by setting its score value to be 0.")]),s._v(" "),e("p",[s._v("Bayesian filtering is used within SpamAssassin as an alternative way of\nfiltering spam. This method can be used to 'teach' SpamAssassin about\nwhat messages you receive are and aren't spam, so that it can better\nexamine messages in the future. In order to use Bayesian filtering\neffectively, you must first have completed all of the above steps, since\nthe rules are stored in your .spamassassin folder.")]),s._v(" "),e("p",[s._v("You do not have to teach SpamAssassin about spam it has already caught,\nas these are automatically added to its ruleset. However, you may want\nto teach it that some messages it missed are actually spam, or some\nmessages it caught are actually non-spam (known as ham).")]),s._v(" "),e("p",[s._v("Any messages that are spam that get through SpamAssassin's filtering\nshould be saved to a separate mail folder (e.g MISSED-SPAM). Once you\nhave collected a few messages, you should run the following command:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  sa-learn --spam --showdots --dir ~/Maildir/.MISSED-SPAM/*\n")])])]),e("p",[s._v("This will process these messages and add them to its ruleset.")]),s._v(" "),e("p",[s._v("To teach SpamAssassin about non-spam (ham) messages, select a mail\nfolder that you know contains no spam. In this example, say you have a\nfolder called WORK, you would run the command:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  sa-learn --ham --showdots --dir ~/Maildir/.WORK/*\n")])])]),e("p",[s._v("This process can be run repeatedly on the same folders over time, since\nSpamAssassin will only process each message once when building up its\nruleset, and will ignore any it has already seen. Equally, this process\nshould be used to re-score any messages that were filtered into your\n.SPAM folder that were actaually ham, by saving them into a folder and\nrepeating the above steps on that folder.")]),s._v(" "),e("p",[s._v("Updating your spamassassin rules:")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  sa-learn --import\n")])])]),e("h2",{attrs:{id:"testing-spamassassin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#testing-spamassassin"}},[s._v("#")]),s._v(" Testing spamassassin")]),s._v(" "),e("p",[s._v('Assuming all your configuration is right, there\'s only one more step: to\ntest it. And it just so happens that somebody has invented the GTUBE,\ni.e. the "Generic Test for Unsolicited Bulk Email". Merely put this line\ninto an e-mail:')]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  XJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X\n")])])]),e("p",[s._v("and send it to yourself. If you check your Maildir/.SPAM directory, for\nexample, using")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  mutt -f ~/Maildir/.SPAM\n")])])]),e("p",[s._v("you should see the mail with the following headers (or something very\nsimilar):")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v("  X-Spam-Flag: YES\n  X-Spam-Checker-Version: SpamAssassin 2.64 (2004-01-11) on\n          mccoy.tardis.ed.ac.uk\n  X-Spam-Level: **************************************************\n  X-Spam-Status: Yes, hits=900.0 required=8.0 tests=GTUBE,USER_IN_WHITELIST\n          autolearn=no version=2.64\n  X-Spam-Report:\n          * 1000 GTUBE BODY: Generic Test for Unsolicited Bulk Email\n          * -100 USER_IN_WHITELIST From: address is in the user's white-list\n")])])]),e("p",[s._v("If so, then congratulations! Spamassassin is now working.")]),s._v(" "),e("p",[e("a",{attrs:{href:"Category:OutOfDate",title:"wikilink"}},[s._v("Category:OutOfDate")])])])}),[],!1,null,null,null);a.default=i.exports}}]);